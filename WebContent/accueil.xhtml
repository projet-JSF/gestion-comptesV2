<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      
      xmlns:p="http://primefaces.org/ui"> 

<h:head></h:head> 
<body> 
<h1>Accueil</h1>
<h2>Bonjour <h:outputText value="#{authenticationBean.conseillerlogged.nom}" />,</h2>

	<!-- ===========Affichage du bouton Se deconnecter =========== -->

	<!-- Vérif de la presence de l'attribut'user_login' dans la session -->
	<!-- la verif via l'attribut rendered qui permet de conditionner l'affichage d'un element jsp -->
	
	
	<h:form rendered="#{not empty user_login}" style ="float : right;">
		<p:commandButton action="#{authenticationBean.deconnecterUtilisateur()}" value="Se deconnecter" />
	
	</h:form>
	
	
		<!-- ===========Affichage de la liste des clients appartenant au conseiller  =========== -->
	<!--  Avec le composant jsf h:datatable -->
	
	
	<h2> Liste des clients</h2>

	<h:form>
		<p:dataTable value="#{gestionClient.findClientsDuConseiller(authenticationBean.conseillerlogged.idConseiller)}" var="client" resizableColumns="true" width="60%" border="1">
			<p:column>
				<!-- En tete de la colonne -->
				<f:facet name="header">
					<h:outputText value="Identifiant client" />
				</f:facet>
				<!-- Donnée de la colonne -->
				<h:outputText value="#{client.idClient }" />
			</p:column>
		
			<p:column>
				<!-- En tete de la colonne -->
				<f:facet name="header">
					<h:outputText value="Nom" />
				</f:facet>
				<!-- Donnée de la colonne -->
				<h:outputText value="#{client.nom }" />
			</p:column>
			
			<p:column>
				<!-- En tete de la colonne -->
				<f:facet name="header">
					<h:outputText value="Prenom" />
				</f:facet>
				<!-- Donnée de la colonne -->
				<h:outputText value="#{client.prenom }" />
			</p:column>
			
			<p:column>
				<!-- En tete de la colonne -->
				<f:facet name="header">
					<h:outputText value="Adresse" />
				</f:facet>
				<!-- Donnée de la colonne -->
				<h:outputText value="#{client.adresse }" />
			</p:column>
			
						<p:column>
				<!-- En tete de la colonne -->
				<f:facet name="header">
					<h:outputText value="Code postal" />
				</f:facet>
				<!-- Donnée de la colonne -->
				<h:outputText value="#{client.codePostal }" />
			</p:column>
			
			<p:column>
				<!-- En tete de la colonne -->
				<f:facet name="header">
					<h:outputText value="Ville" />
				</f:facet>
				<!-- Donnée de la colonne -->
				<h:outputText value="#{client.ville }" />
			</p:column>
			
			<p:column>
				<!-- En tete de la colonne -->
				<f:facet name="header">
					<h:outputText value="Telephone" />
				</f:facet>
				<!-- Donnée de la colonne -->
				<h:outputText value="#{client.telephone }" />
			</p:column>
			
			<p:column>
				<!-- En tete de la colonne -->
				<f:facet name="header">
					<h:outputText value="Conseiller" />
				</f:facet>
				<!-- Donnée de la colonne -->
				<h:outputText value="#{client.conseillerId}" />
			</p:column>
			
			
			
			<!-- Colonne pour supprimer le client -->
			
			<p:column>
				<!-- En tete de la colonne -->
				<f:facet name="header">
					<h:outputText value="Supprimer" />
				</f:facet>
				<!-- Donnée de la colonne -->
				
				<!--  Attribut du lien h:commandLink :
							- action : clé d'outcom pour la navigation (ref faces-config.xml)
							- actionListener : méthode à invoquer dans le managed bean
				-->
				
				
				<h:commandLink id="delete" action="listClient" actionListener="#{gestionClient.supprimerClient}" >
					
						<!-- Passage de parametre au composant : nom deleteID / valeur = l'id du client -->
						<f:param id="deleteID" name="id" value="#{client.idClient}"/>
						
						<!--  label du lien  -->
						<h:outputText value="supprimer" />
				
				</h:commandLink>
				
			</p:column>
			
			
			
			<!-- Colonne pour modifier le client -->
			
			<p:column>
				<!-- En tete de la colonne -->
				<f:facet name="header">
					<h:outputText value="Modifier" />
				</f:facet>
				<!-- Donnée de la colonne -->
				
				<!--  Attribut du lien h:commandLink :
							- action : clé d'outcom pour la navigation (ref faces-config.xml)
							- actionListener : méthode à invoquer dans le managed bean
				-->
				
				
				<h:commandLink id="update" action="editClient" actionListener="#{gestionClient.selectionnerClient}" >
					
						<!-- Passage de parametre au composant : nom deleteID / valeur = l'id du client -->
						<f:param id="updateID" name="id" value="#{client.idClient}"/>
						
						<!--  label du lien  -->
						<h:outputText value="Modifier" />
				
				</h:commandLink>
				
			</p:column>
		
		</p:dataTable>
		
		<br/><br/>
		<!--  ==============Bouton pour ajouter un client ===========================  -->
		
		<!-- attribut de h:commandButton :
				action : clé d'outcom (cf faces-config.xml)
				actionListener : méthode à invoquer la le managedbean
				value : label du bouton
		 -->
		<p:commandButton action="addClient" actionListener="#{gestionClient.initialiserClient}" value="Ajouter un nouveau client" />
	</h:form>
	
	
<!-- ==================================================================================== -->
<!-- =================================PARTIE COMPTE====================================== -->
<!-- ==================================================================================== -->

<!-- ===========Affichage de la liste des comptes appartenant au Conseiller =========== -->
	<!--  Avec le composant jsf h:datatable -->
	
	
	<h2> Liste des comptes</h2>

	<h:form>
		<p:dataTable value="#{gestionCompte.findComptesDuConseiller(authenticationBean.conseillerlogged.idConseiller)}" var="compte" resizableColumns="true" width="60%" border="1">
			<p:column>
				<!-- En tete de la colonne -->
				<f:facet name="header">
					<h:outputText value="Identifiant compte" />
				</f:facet>
				<!-- Donnée de la colonne -->
				<h:outputText value="#{compte.idCompte }" />
			</p:column>
		
			<p:column>
				<!-- En tete de la colonne -->
				<f:facet name="header">
					<h:outputText value="CompteId" />
				</f:facet>
				<!-- Donnée de la colonne -->
				<h:outputText value="#{compte.compteId }" />
			</p:column>
			
			<p:column>
				<!-- En tete de la colonne -->
				<f:facet name="header">
					<h:outputText value="Solde" />
				</f:facet>
				<!-- Donnée de la colonne -->
				<h:outputText value="#{compte.solde }" />
			</p:column>
			
			<p:column>
				<!-- En tete de la colonne -->
				<f:facet name="header">
					<h:outputText value="TypeCompte" />
				</f:facet>
				<!-- Donnée de la colonne -->
				<h:outputText value="#{compte.typeCompte }" />
			</p:column>
			
						<p:column>
				<!-- En tete de la colonne -->
				<f:facet name="header">
					<h:outputText value="Taux" />
				</f:facet>
				<!-- Donnée de la colonne -->
				<h:outputText value="#{compte.taux }" />
			</p:column>
			
			<p:column>
				<!-- En tete de la colonne -->
				<f:facet name="header">
					<h:outputText value="Decouvert" />
				</f:facet>
				<!-- Donnée de la colonne -->
				<h:outputText value="#{compte.decouvert }" />
			</p:column>
			
			
			
			<!-- Colonne pour supprimer le compte -->
			
			<p:column>
				<!-- En tete de la colonne -->
				<f:facet name="header">
					<h:outputText value="Supprimer" />
				</f:facet>
				<!-- Donnée de la colonne -->
				
				<!--  Attribut du lien h:commandLink :
							- action : clé d'outcom pour la navigation (ref faces-config.xml)
							- actionListener : méthode à invoquer dans le managed bean
				-->
				
				
				<h:commandLink id="delete" action="listCompte" actionListener="#{gestionCompte.supprimerCompte}" >
					
						<!-- Passage de parametre au composant : idCompte deleteID / valeur = l'id du compte -->
						<f:param id="deleteID" name="id" value="#{compte.idCompte}"/>
						
						<!--  label du lien  -->
						<h:outputText value="supprimer" />
				
				</h:commandLink>
				
			</p:column>
			
			
			
			<!-- Colonne pour modifier le compte -->
			
			<p:column>
				<!-- En tete de la colonne -->
				<f:facet name="header">
					<h:outputText value="Modifier" />
				</f:facet>
				<!-- Donnée de la colonne -->
				
				<!--  Attribut du lien h:commandLink :
							- action : clé d'outcom pour la navigation (ref faces-config.xml)
							- actionListener : méthode à invoquer dans le managed bean
				-->
				
				
				<h:commandLink id="update" action="editCompte" actionListener="#{gestionCompte.selectionnerCompte}" >
					
						<!-- Passage de parametre au composant : idCompte deleteID / valeur = l'id du compte -->
						<f:param id="updateID" name="id" value="#{compte.idCompte}"/>
						
						<!--  label du lien  -->
						<h:outputText value="Modifier" />
				
				</h:commandLink>
				
			</p:column>
		
		</p:dataTable>
		
		<br/><br/>
		<!--  ==============Bouton pour ajouter un compte ===========================  -->
		
		<!-- attribut de h:commandButton :
				action : clé d'outcom (cf faces-config.xml)
				actionListener : méthode à invoquer la le managedbean
				value : label du bouton
		 -->
		<p:commandButton action="addCompte" actionListener="#{gestionCompte.initialiserCompte}" value="Ajouter un nouveau compte" />
	</h:form>

</body> 
</html>
